<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>gsw.gibbs.density_enthalpy_48 &#8212; gsw  documentation</title>
    
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for gsw.gibbs.density_enthalpy_48</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">division</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">.library</span> <span class="k">import</span> <span class="n">specvol_SSO_0_p</span>
<span class="kn">from</span> <span class="nn">.constants</span> <span class="k">import</span> <span class="n">P0</span><span class="p">,</span> <span class="n">db2Pascal</span><span class="p">,</span> <span class="n">cp0</span>
<span class="kn">from</span> <span class="nn">..utilities</span> <span class="k">import</span> <span class="n">match_args_return</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span>
           <span class="s1">&#39;alpha_on_beta&#39;</span><span class="p">,</span>
           <span class="s1">&#39;alpha_on_beta_CT&#39;</span><span class="p">,</span>
           <span class="s1">&#39;beta&#39;</span><span class="p">,</span>
           <span class="s1">&#39;dynamic_enthalpy&#39;</span><span class="p">,</span>
           <span class="s1">&#39;enthalpy&#39;</span><span class="p">,</span>
           <span class="s1">&#39;enthalpy_diff&#39;</span><span class="p">,</span>
           <span class="s1">&#39;internal_energy&#39;</span><span class="p">,</span>
           <span class="s1">&#39;rho&#39;</span><span class="p">,</span>
           <span class="s1">&#39;rho_alpha_beta&#39;</span><span class="p">,</span>
           <span class="s1">&#39;SA_from_rho&#39;</span><span class="p">,</span>
           <span class="s1">&#39;sigma0&#39;</span><span class="p">,</span>
           <span class="s1">&#39;sigma1&#39;</span><span class="p">,</span>
           <span class="s1">&#39;sigma2&#39;</span><span class="p">,</span>
           <span class="s1">&#39;sigma3&#39;</span><span class="p">,</span>
           <span class="s1">&#39;sigma4&#39;</span><span class="p">,</span>
           <span class="s1">&#39;sound_speed&#39;</span><span class="p">,</span>
           <span class="s1">&#39;specvol&#39;</span><span class="p">,</span>
           <span class="s1">&#39;specvol_anom&#39;</span><span class="p">]</span>


<span class="c1"># NOTE: these are from gsw_rho_alpha_beta.m</span>
<span class="n">v01</span> <span class="o">=</span> <span class="mf">9.998420897506056e+2</span>
<span class="n">v02</span> <span class="o">=</span> <span class="mf">2.839940833161907</span>
<span class="n">v03</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.147759265588511e-2</span>
<span class="n">v04</span> <span class="o">=</span> <span class="mf">1.181805545074306e-3</span>
<span class="n">v05</span> <span class="o">=</span> <span class="o">-</span><span class="mf">6.698001071123802</span>
<span class="n">v06</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.986498947203215e-2</span>
<span class="n">v07</span> <span class="o">=</span> <span class="mf">2.327859407479162e-4</span>
<span class="n">v08</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.988822378968490e-2</span>
<span class="n">v09</span> <span class="o">=</span> <span class="mf">5.095422573880500e-4</span>
<span class="n">v10</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.426984671633621e-5</span>
<span class="n">v11</span> <span class="o">=</span> <span class="mf">1.645039373682922e-7</span>
<span class="n">v12</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.233269627352527e-2</span>
<span class="n">v13</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.436090079851880e-4</span>
<span class="n">v14</span> <span class="o">=</span> <span class="mf">3.726050720345733e-6</span>
<span class="n">v15</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.806789763745328e-4</span>
<span class="n">v16</span> <span class="o">=</span> <span class="mf">6.876837219536232e-7</span>
<span class="n">v17</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.087032500374211e-7</span>
<span class="n">v18</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.988366587925593e-8</span>
<span class="n">v19</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.061519070296458e-11</span>
<span class="n">v20</span> <span class="o">=</span> <span class="mf">1.550932729220080e-10</span>
<span class="n">v21</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">v22</span> <span class="o">=</span> <span class="mf">2.775927747785646e-3</span>
<span class="n">v23</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.349607444135925e-5</span>
<span class="n">v24</span> <span class="o">=</span> <span class="mf">1.119513357486743e-6</span>
<span class="n">v25</span> <span class="o">=</span> <span class="mf">6.743689325042773e-10</span>
<span class="n">v26</span> <span class="o">=</span> <span class="o">-</span><span class="mf">7.521448093615448e-3</span>
<span class="n">v27</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.764306979894411e-5</span>
<span class="n">v28</span> <span class="o">=</span> <span class="mf">1.262937315098546e-7</span>
<span class="n">v29</span> <span class="o">=</span> <span class="mf">9.527875081696435e-10</span>
<span class="n">v30</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.811147201949891e-11</span>
<span class="n">v31</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.303308871386421e-5</span>
<span class="n">v32</span> <span class="o">=</span> <span class="mf">3.801564588876298e-7</span>
<span class="n">v33</span> <span class="o">=</span> <span class="o">-</span><span class="mf">7.672876869259043e-9</span>
<span class="n">v34</span> <span class="o">=</span> <span class="o">-</span><span class="mf">4.634182341116144e-11</span>
<span class="n">v35</span> <span class="o">=</span> <span class="mf">2.681097235569143e-12</span>
<span class="n">v36</span> <span class="o">=</span> <span class="mf">5.419326551148740e-6</span>
<span class="n">v37</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.742185394906099e-5</span>
<span class="n">v38</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.212746477974189e-7</span>
<span class="n">v39</span> <span class="o">=</span> <span class="mf">3.191413910561627e-9</span>
<span class="n">v40</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.931012931541776e-12</span>
<span class="n">v41</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.105097577149576e-7</span>
<span class="n">v42</span> <span class="o">=</span> <span class="mf">6.211426728363857e-10</span>
<span class="n">v43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.119011592875110e-10</span>
<span class="n">v44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.941660213148725e-11</span>
<span class="n">v45</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.864826425365600e-14</span>
<span class="n">v46</span> <span class="o">=</span> <span class="mf">1.119522344879478e-14</span>
<span class="n">v47</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.200507748551599e-15</span>
<span class="n">v48</span> <span class="o">=</span> <span class="mf">6.057902487546866e-17</span>

<span class="n">a01</span> <span class="o">=</span> <span class="mf">2.839940833161907</span>
<span class="n">a02</span> <span class="o">=</span> <span class="o">-</span><span class="mf">6.295518531177023e-2</span>
<span class="n">a03</span> <span class="o">=</span> <span class="mf">3.545416635222918e-3</span>
<span class="n">a04</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.986498947203215e-2</span>
<span class="n">a05</span> <span class="o">=</span> <span class="mf">4.655718814958324e-4</span>
<span class="n">a06</span> <span class="o">=</span> <span class="mf">5.095422573880500e-4</span>
<span class="n">a07</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.853969343267241e-5</span>
<span class="n">a08</span> <span class="o">=</span> <span class="mf">4.935118121048767e-7</span>
<span class="n">a09</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.436090079851880e-4</span>
<span class="n">a10</span> <span class="o">=</span> <span class="mf">7.452101440691467e-6</span>
<span class="n">a11</span> <span class="o">=</span> <span class="mf">6.876837219536232e-7</span>
<span class="n">a12</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.988366587925593e-8</span>
<span class="n">a13</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.123038140592916e-11</span>

<span class="n">a14</span> <span class="o">=</span> <span class="mf">2.775927747785646e-3</span>
<span class="n">a15</span> <span class="o">=</span> <span class="o">-</span><span class="mf">4.699214888271850e-5</span>
<span class="n">a16</span> <span class="o">=</span> <span class="mf">3.358540072460230e-6</span>
<span class="n">a17</span> <span class="o">=</span> <span class="mf">2.697475730017109e-9</span>
<span class="n">a18</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.764306979894411e-5</span>
<span class="n">a19</span> <span class="o">=</span> <span class="mf">2.525874630197091e-7</span>
<span class="n">a20</span> <span class="o">=</span> <span class="mf">2.858362524508931e-9</span>
<span class="n">a21</span> <span class="o">=</span> <span class="o">-</span><span class="mf">7.244588807799565e-11</span>
<span class="n">a22</span> <span class="o">=</span> <span class="mf">3.801564588876298e-7</span>
<span class="n">a23</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.534575373851809e-8</span>
<span class="n">a24</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.390254702334843e-10</span>
<span class="n">a25</span> <span class="o">=</span> <span class="mf">1.072438894227657e-11</span>
<span class="n">a26</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.212746477974189e-7</span>
<span class="n">a27</span> <span class="o">=</span> <span class="mf">6.382827821123254e-9</span>
<span class="n">a28</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.793038794625329e-12</span>
<span class="n">a29</span> <span class="o">=</span> <span class="mf">6.211426728363857e-10</span>
<span class="n">a30</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.941660213148725e-11</span>
<span class="n">a31</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.729652850731201e-14</span>
<span class="n">a32</span> <span class="o">=</span> <span class="mf">1.119522344879478e-14</span>
<span class="n">a33</span> <span class="o">=</span> <span class="mf">6.057902487546866e-17</span>

<span class="n">b01</span> <span class="o">=</span> <span class="o">-</span><span class="mf">6.698001071123802</span>
<span class="n">b02</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.986498947203215e-2</span>
<span class="n">b03</span> <span class="o">=</span> <span class="mf">2.327859407479162e-4</span>
<span class="n">b04</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.983233568452735e-2</span>
<span class="n">b05</span> <span class="o">=</span> <span class="mf">7.643133860820750e-4</span>
<span class="n">b06</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.140477007450431e-5</span>
<span class="n">b07</span> <span class="o">=</span> <span class="mf">2.467559060524383e-7</span>
<span class="n">b08</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.806789763745328e-4</span>
<span class="n">b09</span> <span class="o">=</span> <span class="mf">6.876837219536232e-7</span>
<span class="n">b10</span> <span class="o">=</span> <span class="mf">1.550932729220080e-10</span>
<span class="n">b11</span> <span class="o">=</span> <span class="o">-</span><span class="mf">7.521448093615448e-3</span>
<span class="n">b12</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.764306979894411e-5</span>
<span class="n">b13</span> <span class="o">=</span> <span class="mf">1.262937315098546e-7</span>
<span class="n">b14</span> <span class="o">=</span> <span class="mf">9.527875081696435e-10</span>
<span class="n">b15</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.811147201949891e-11</span>
<span class="n">b16</span> <span class="o">=</span> <span class="o">-</span><span class="mf">4.954963307079632e-5</span>
<span class="n">b17</span> <span class="o">=</span> <span class="mf">5.702346883314446e-7</span>
<span class="n">b18</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.150931530388857e-8</span>
<span class="n">b19</span> <span class="o">=</span> <span class="o">-</span><span class="mf">6.951273511674217e-11</span>
<span class="n">b20</span> <span class="o">=</span> <span class="mf">4.021645853353715e-12</span>
<span class="n">b21</span> <span class="o">=</span> <span class="mf">1.083865310229748e-5</span>
<span class="n">b22</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.105097577149576e-7</span>
<span class="n">b23</span> <span class="o">=</span> <span class="mf">6.211426728363857e-10</span>
<span class="n">b24</span> <span class="o">=</span> <span class="mf">1.119522344879478e-14</span>

<span class="n">c01</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.233269627352527e-2</span>
<span class="n">c02</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.436090079851880e-4</span>
<span class="n">c03</span> <span class="o">=</span> <span class="mf">3.726050720345733e-6</span>
<span class="n">c04</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.806789763745328e-4</span>
<span class="n">c05</span> <span class="o">=</span> <span class="mf">6.876837219536232e-7</span>
<span class="n">c06</span> <span class="o">=</span> <span class="o">-</span><span class="mf">6.174065000748422e-7</span>
<span class="n">c07</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.976733175851186e-8</span>
<span class="n">c08</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.123038140592916e-11</span>
<span class="n">c09</span> <span class="o">=</span> <span class="mf">3.101865458440160e-10</span>
<span class="n">c10</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.742185394906099e-5</span>
<span class="n">c11</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.212746477974189e-7</span>
<span class="n">c12</span> <span class="o">=</span> <span class="mf">3.191413910561627e-9</span>
<span class="n">c13</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.931012931541776e-12</span>
<span class="n">c14</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.105097577149576e-7</span>
<span class="n">c15</span> <span class="o">=</span> <span class="mf">6.211426728363857e-10</span>
<span class="n">c16</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.238023185750219e-10</span>
<span class="n">c17</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.883320426297450e-11</span>
<span class="n">c18</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.729652850731201e-14</span>
<span class="n">c19</span> <span class="o">=</span> <span class="mf">2.239044689758956e-14</span>
<span class="n">c20</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.601523245654798e-15</span>
<span class="n">c21</span> <span class="o">=</span> <span class="mf">1.817370746264060e-16</span>

<span class="c1"># Helper functions that are used by more than one user function.</span>
<span class="c1"># FIXME: arrange all these things so that inputs to these</span>
<span class="c1"># functions are done with ordinary ndarrays with nans, not</span>
<span class="c1"># masked arrays.  We might need a different decorator for this.</span>


<span class="k">def</span> <span class="nf">v_hat_denominator</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">sqrtSA</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">v01</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v02</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v03</span> <span class="o">+</span> <span class="n">v04</span><span class="o">*</span><span class="n">CT</span><span class="p">))</span> <span class="o">+</span>
            <span class="n">SA</span> <span class="o">*</span>
            <span class="p">(</span><span class="n">v05</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v06</span> <span class="o">+</span> <span class="n">v07</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrtSA</span> <span class="o">*</span>
             <span class="p">(</span><span class="n">v08</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v09</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v10</span> <span class="o">+</span> <span class="n">v11</span> <span class="o">*</span> <span class="n">CT</span><span class="p">))))</span> <span class="o">+</span>
            <span class="n">p</span> <span class="o">*</span>
            <span class="p">(</span><span class="n">v12</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v13</span> <span class="o">+</span> <span class="n">v14</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)</span> <span class="o">+</span> <span class="n">SA</span> <span class="o">*</span> <span class="p">(</span><span class="n">v15</span> <span class="o">+</span> <span class="n">v16</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)</span> <span class="o">+</span>
             <span class="n">p</span> <span class="o">*</span> <span class="p">(</span><span class="n">v17</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v18</span> <span class="o">+</span> <span class="n">v19</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)</span> <span class="o">+</span> <span class="n">v20</span> <span class="o">*</span> <span class="n">SA</span><span class="p">)))</span>


<span class="k">def</span> <span class="nf">v_hat_numerator</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">sqrtSA</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">v21</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v22</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v23</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v24</span> <span class="o">+</span> <span class="n">v25</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)))</span> <span class="o">+</span>
            <span class="n">SA</span> <span class="o">*</span>
            <span class="p">(</span><span class="n">v26</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v27</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v28</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v29</span> <span class="o">+</span> <span class="n">v30</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)))</span> <span class="o">+</span>
             <span class="n">v36</span> <span class="o">*</span> <span class="n">SA</span> <span class="o">+</span> <span class="n">sqrtSA</span> <span class="o">*</span>
             <span class="p">(</span><span class="n">v31</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v32</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v33</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v34</span> <span class="o">+</span> <span class="n">v35</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)))))</span> <span class="o">+</span>
            <span class="n">p</span> <span class="o">*</span>
            <span class="p">(</span><span class="n">v37</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v38</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v39</span> <span class="o">+</span> <span class="n">v40</span> <span class="o">*</span> <span class="n">CT</span><span class="p">))</span> <span class="o">+</span> <span class="n">SA</span> <span class="o">*</span>
             <span class="p">(</span><span class="n">v41</span> <span class="o">+</span> <span class="n">v42</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)</span> <span class="o">+</span> <span class="n">p</span> <span class="o">*</span>
             <span class="p">(</span><span class="n">v43</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v44</span> <span class="o">+</span> <span class="n">v45</span> <span class="o">*</span> <span class="n">CT</span> <span class="o">+</span> <span class="n">v46</span> <span class="o">*</span> <span class="n">SA</span><span class="p">)</span> <span class="o">+</span> <span class="n">p</span> <span class="o">*</span> <span class="p">(</span><span class="n">v47</span> <span class="o">+</span> <span class="n">v48</span> <span class="o">*</span> <span class="n">CT</span><span class="p">))))</span>


<span class="c1"># Next 4 are from alpha on beta:</span>
<span class="k">def</span> <span class="nf">dvhatden_dCT</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">sqrtSA</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">a01</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">a02</span> <span class="o">+</span> <span class="n">a03</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)</span> <span class="o">+</span> <span class="n">SA</span> <span class="o">*</span>
            <span class="p">(</span><span class="n">a04</span> <span class="o">+</span> <span class="n">a05</span> <span class="o">*</span> <span class="n">CT</span> <span class="o">+</span> <span class="n">sqrtSA</span> <span class="o">*</span> <span class="p">(</span><span class="n">a06</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">a07</span> <span class="o">+</span> <span class="n">a08</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)))</span> <span class="o">+</span>
            <span class="n">p</span> <span class="o">*</span> <span class="p">(</span><span class="n">a09</span> <span class="o">+</span> <span class="n">a10</span> <span class="o">*</span> <span class="n">CT</span> <span class="o">+</span> <span class="n">a11</span> <span class="o">*</span> <span class="n">SA</span> <span class="o">+</span> <span class="n">p</span> <span class="o">*</span> <span class="p">(</span><span class="n">a12</span> <span class="o">+</span> <span class="n">a13</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)))</span>


<span class="k">def</span> <span class="nf">dvhatnum_dCT</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">sqrtSA</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">a14</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">a15</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">a16</span> <span class="o">+</span> <span class="n">a17</span> <span class="o">*</span> <span class="n">CT</span><span class="p">))</span> <span class="o">+</span> <span class="n">SA</span> <span class="o">*</span>
            <span class="p">(</span><span class="n">a18</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">a19</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">a20</span> <span class="o">+</span> <span class="n">a21</span> <span class="o">*</span> <span class="n">CT</span><span class="p">))</span> <span class="o">+</span> <span class="n">sqrtSA</span> <span class="o">*</span>
             <span class="p">(</span><span class="n">a22</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">a23</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">a24</span> <span class="o">+</span> <span class="n">a25</span> <span class="o">*</span> <span class="n">CT</span><span class="p">))))</span> <span class="o">+</span> <span class="n">p</span> <span class="o">*</span>
            <span class="p">(</span><span class="n">a26</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">a27</span> <span class="o">+</span> <span class="n">a28</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)</span> <span class="o">+</span> <span class="n">a29</span> <span class="o">*</span> <span class="n">SA</span> <span class="o">+</span> <span class="n">p</span> <span class="o">*</span>
             <span class="p">(</span><span class="n">a30</span> <span class="o">+</span> <span class="n">a31</span> <span class="o">*</span> <span class="n">CT</span> <span class="o">+</span> <span class="n">a32</span> <span class="o">*</span> <span class="n">SA</span> <span class="o">+</span> <span class="n">a33</span> <span class="o">*</span> <span class="n">p</span><span class="p">)))</span>


<span class="k">def</span> <span class="nf">dvhatden_dSA</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">sqrtSA</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">b01</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">b02</span> <span class="o">+</span> <span class="n">b03</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrtSA</span> <span class="o">*</span>
            <span class="p">(</span><span class="n">b04</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">b05</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">b06</span> <span class="o">+</span> <span class="n">b07</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)))</span> <span class="o">+</span>
            <span class="n">p</span> <span class="o">*</span> <span class="p">(</span><span class="n">b08</span> <span class="o">+</span> <span class="n">b09</span> <span class="o">*</span> <span class="n">CT</span> <span class="o">+</span> <span class="n">b10</span> <span class="o">*</span> <span class="n">p</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">dvhatnum_dSA</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">sqrtSA</span><span class="p">):</span>
    <span class="k">return</span><span class="p">(</span><span class="n">b11</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">b12</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">b13</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">b14</span> <span class="o">+</span> <span class="n">b15</span><span class="o">*</span><span class="n">CT</span><span class="p">)))</span>
           <span class="o">+</span> <span class="n">sqrtSA</span> <span class="o">*</span> <span class="p">(</span><span class="n">b16</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">b17</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">b18</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">b19</span> <span class="o">+</span> <span class="n">b20</span><span class="o">*</span><span class="n">CT</span><span class="p">))))</span>
           <span class="o">+</span> <span class="n">b21</span><span class="o">*</span><span class="n">SA</span>
           <span class="o">+</span> <span class="n">p</span> <span class="o">*</span> <span class="p">(</span><span class="n">b22</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">b23</span> <span class="o">+</span> <span class="n">b24</span><span class="o">*</span><span class="n">p</span><span class="p">)))</span>


<span class="nd">@match_args_return</span>
<div class="viewcode-block" id="alpha_on_beta"><a class="viewcode-back" href="../../../gsw.gibbs.html#gsw.gibbs.density_enthalpy_48.alpha_on_beta">[docs]</a><span class="k">def</span> <span class="nf">alpha_on_beta</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">     gsw_alpha_on_beta                           alpha/beta (48-term equation)</span>
<span class="sd">    ==========================================================================</span>

<span class="sd">     USAGE:</span>
<span class="sd">     alpha_on_beta = gsw_alpha_on_beta(SA,CT,p)</span>

<span class="sd">     DESCRIPTION:</span>
<span class="sd">      Calculates alpha divided by beta, where alpha is the thermal expansion</span>
<span class="sd">      coefficient and beta is the saline contraction coefficient of seawater</span>
<span class="sd">      from Absolute Salinity and Conservative Temperature.  This function uses</span>
<span class="sd">      the computationally-efficient 48-term expression for density in terms of</span>
<span class="sd">      SA, CT and p (IOC et al., 2010).</span>

<span class="sd">      Note that the 48-term equation has been fitted in a restricted range of</span>
<span class="sd">      parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">      described in IOC et al. (2010).  The GSW library function</span>
<span class="sd">      &quot;gsw_infunnel(SA,CT,p)&quot; is avaialble to be used if one wants to test if</span>
<span class="sd">      some of one&#39;s data lies outside this &quot;funnel&quot;.</span>

<span class="sd">     INPUT:</span>
<span class="sd">      SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="sd">      CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="sd">      p   =  sea pressure                                             [ dbar ]</span>
<span class="sd">             ( i.e. absolute pressure - 10.1325 dbar )</span>

<span class="sd">      SA &amp; CT need to have the same dimensions.</span>
<span class="sd">      p may have dimensions 1x1 or Mx1 or 1xN or MxN, where SA &amp; CT are MxN.</span>

<span class="sd">     OUTPUT:</span>
<span class="sd">      alpha_on_beta  =  thermal expansion coefficient with respect to</span>
<span class="sd">                        Conservative Temperature divided by the saline</span>
<span class="sd">                        contraction coefficient at constant Conservative</span>
<span class="sd">                        Temperature                           [ kg g^-1 K^-1 ]</span>

<span class="sd">     AUTHOR:</span>
<span class="sd">      Paul Barker and Trevor McDougall                    [ help@teos-10.org ]</span>

<span class="sd">     VERSION NUMBER: 3.03 (10th May, 2013)</span>

<span class="sd">     REFERENCES:</span>
<span class="sd">      IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">      seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">      Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">      UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">sqrtSA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">SA</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">sqrtSA</span>

    <span class="n">num</span> <span class="o">=</span> <span class="p">(</span><span class="n">dvhatnum_dCT</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">*</span> <span class="n">v_hat_denominator</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">-</span>
           <span class="n">dvhatden_dCT</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">*</span> <span class="n">v_hat_numerator</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">))</span>
    <span class="n">denom</span> <span class="o">=</span> <span class="p">(</span><span class="n">dvhatden_dSA</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">*</span> <span class="n">v_hat_numerator</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">-</span>
             <span class="n">dvhatnum_dSA</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">*</span> <span class="n">v_hat_denominator</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">num</span> <span class="o">/</span> <span class="n">denom</span></div>

<span class="n">alpha_on_beta_CT</span> <span class="o">=</span> <span class="n">alpha_on_beta</span>


<span class="nd">@match_args_return</span>
<div class="viewcode-block" id="alpha"><a class="viewcode-back" href="../../../gsw.gibbs.html#gsw.gibbs.density_enthalpy_48.alpha">[docs]</a><span class="k">def</span> <span class="nf">alpha</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the thermal expansion coefficient of seawater with respect</span>
<span class="sd">    to Conservative Temperature using the computationally-efficient 48-term</span>
<span class="sd">    expression for density in terms of SA, CT and p (McDougall et al., 2011)</span>


<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array_like</span>
<span class="sd">         Absolute Salinity  [g/kg]</span>
<span class="sd">    CT : array_like</span>
<span class="sd">         Conservative Temperature [:math:`^\circ` C (ITS-90)]</span>
<span class="sd">    p : array_like</span>
<span class="sd">        sea pressure [dbar]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    alpha : array_like</span>
<span class="sd">            thermal expansion coefficient [K :math:`-1`]</span>
<span class="sd">            with respect to Conservative Temperature</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The 48-term equation has been fitted in a restricted range of parameter</span>
<span class="sd">    space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2011).  The GSW library function</span>
<span class="sd">    &quot;infunnel(SA, CT, p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    TODO</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] IOC, SCOR and IAPSO, 2010: The international thermodynamic equation</span>
<span class="sd">       of seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">       Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">       UNESCO (English), 196 pp. See Eqn. (2.18.3).</span>

<span class="sd">    .. [2] McDougall T.J., P.M. Barker, R. Feistel and D.R. Jackett, 2011:  A</span>
<span class="sd">       computationally efficient 48-term expression for the density of</span>
<span class="sd">       seawater in terms of Conservative Temperature, and related properties</span>
<span class="sd">       of seawater.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">sqrtSA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">SA</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">sqrtSA</span>

    <span class="n">spec_vol</span> <span class="o">=</span> <span class="n">v_hat_numerator</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">/</span> <span class="n">v_hat_denominator</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">((</span><span class="n">dvhatnum_dCT</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">-</span> <span class="n">dvhatden_dCT</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">*</span> <span class="n">spec_vol</span><span class="p">)</span> <span class="o">/</span>
            <span class="n">v_hat_numerator</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">))</span></div>


<span class="nd">@match_args_return</span>
<div class="viewcode-block" id="beta"><a class="viewcode-back" href="../../../gsw.gibbs.html#gsw.gibbs.density_enthalpy_48.beta">[docs]</a><span class="k">def</span> <span class="nf">beta</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the saline (i.e. haline) contraction coefficient of seawater</span>
<span class="sd">    at constant Conservative Temperature using the computationally-efficient</span>
<span class="sd">    48-term expression for density in terms of SA, CT and p (McDougall et al.,</span>
<span class="sd">    2011).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array_like</span>
<span class="sd">         Absolute Salinity  [g/kg]</span>
<span class="sd">    CT : array_like</span>
<span class="sd">         Conservative Temperature [:math:`^\circ` C (ITS-90)]</span>
<span class="sd">    p : array_like</span>
<span class="sd">        sea pressure [dbar]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    beta : array_like</span>
<span class="sd">           saline contraction coefficient [kg g :math:`-1`]</span>
<span class="sd">           at constant Conservative Temperature.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The 48-term equation has been fitted in a restricted range of parameter</span>
<span class="sd">    space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2011).  The GSW library function</span>
<span class="sd">    &quot;infunnel(SA, CT, p)&quot; is available to be used if one wants to test if some</span>
<span class="sd">    of one&#39;s data lies outside this &quot;funnel&quot;.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    TODO</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] IOC, SCOR and IAPSO, 2010: The international thermodynamic equation</span>
<span class="sd">       of seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">       Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">       UNESCO (English), 196 pp. See Eqn. (2.19.3).</span>

<span class="sd">    .. [2] McDougall T.J., P.M. Barker, R. Feistel and D.R. Jackett, 2011:  A</span>
<span class="sd">       computationally efficient 48-term expression for the density of</span>
<span class="sd">       seawater in terms of Conservative Temperature, and related properties</span>
<span class="sd">       of seawater.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">sqrtSA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">SA</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">sqrtSA</span>

    <span class="n">spec_vol</span> <span class="o">=</span> <span class="n">v_hat_numerator</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">/</span> <span class="n">v_hat_denominator</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">((</span><span class="n">dvhatden_dSA</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">*</span> <span class="n">spec_vol</span> <span class="o">-</span> <span class="n">dvhatnum_dSA</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">))</span> <span class="o">/</span>
            <span class="n">v_hat_numerator</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">))</span></div>


<span class="nd">@match_args_return</span>
<div class="viewcode-block" id="dynamic_enthalpy"><a class="viewcode-back" href="../../../gsw.gibbs.html#gsw.gibbs.density_enthalpy_48.dynamic_enthalpy">[docs]</a><span class="k">def</span> <span class="nf">dynamic_enthalpy</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates dynamic enthalpy of seawater using the computationally-</span>
<span class="sd">    efficient 48-term expression for density in terms of SA, CT and p</span>
<span class="sd">    (McDougall et al., 2011).  Dynamic enthalpy is defined as enthalpy minus</span>
<span class="sd">    potential enthalpy (Young, 2010).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array_like</span>
<span class="sd">         Absolute Salinity  [g/kg]</span>
<span class="sd">    CT : array_like</span>
<span class="sd">         Conservative Temperature [:math:`^\circ` C (ITS-90)]</span>
<span class="sd">    p : array_like</span>
<span class="sd">        sea pressure [dbar]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dynamic_enthalpy : array_like</span>
<span class="sd">                       dynamic enthalpy [J/kg]</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The 48-term equation has been fitted in a restricted range of parameter</span>
<span class="sd">    space, and is most accurate inside the &quot;oceanographic funnel&quot; described in</span>
<span class="sd">    McDougall et al. (2011).  The GSW library function &quot;infunnel(SA, CT, p)&quot; is</span>
<span class="sd">    available to be used if one wants to test if some of one&#39;s data lies</span>
<span class="sd">    outside this &quot;funnel&quot;.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    TODO</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] IOC, SCOR and IAPSO, 2010: The international thermodynamic equation</span>
<span class="sd">       of seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">       Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">       UNESCO (English), 196 pp. See section 3.2</span>

<span class="sd">    .. [2] McDougall T.J., P.M. Barker, R. Feistel and D.R. Jackett, 2011:  A</span>
<span class="sd">       computationally efficient 48-term expression for the density of</span>
<span class="sd">       seawater in terms of Conservative Temperature, and related properties</span>
<span class="sd">       of seawater.</span>

<span class="sd">    .. [3] Young, W.R., 2010: Dynamic enthalpy, Conservative Temperature, and</span>
<span class="sd">       the seawater Boussinesq approximation. Journal of Physical Oceanography,</span>
<span class="sd">       40, 394-400.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="n">sqrtSA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">SA</span><span class="p">)</span>

    <span class="n">a0</span> <span class="o">=</span> <span class="p">(</span><span class="n">v21</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v22</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v23</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v24</span> <span class="o">+</span> <span class="n">v25</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)))</span> <span class="o">+</span> <span class="n">SA</span> <span class="o">*</span>
          <span class="p">(</span><span class="n">v26</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v27</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v28</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v29</span> <span class="o">+</span> <span class="n">v30</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)))</span> <span class="o">+</span> <span class="n">v36</span> <span class="o">*</span> <span class="n">SA</span> <span class="o">+</span>
           <span class="n">sqrtSA</span> <span class="o">*</span> <span class="p">(</span><span class="n">v31</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v32</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v33</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v34</span> <span class="o">+</span> <span class="n">v35</span> <span class="o">*</span> <span class="n">CT</span><span class="p">))))))</span>

    <span class="n">a1</span> <span class="o">=</span> <span class="n">v37</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v38</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v39</span> <span class="o">+</span> <span class="n">v40</span> <span class="o">*</span> <span class="n">CT</span><span class="p">))</span> <span class="o">+</span> <span class="n">SA</span> <span class="o">*</span> <span class="p">(</span><span class="n">v41</span> <span class="o">+</span> <span class="n">v42</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)</span>

    <span class="n">a2</span> <span class="o">=</span> <span class="n">v43</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v44</span> <span class="o">+</span> <span class="n">v45</span> <span class="o">*</span> <span class="n">CT</span> <span class="o">+</span> <span class="n">v46</span> <span class="o">*</span> <span class="n">SA</span><span class="p">)</span>

    <span class="n">a3</span> <span class="o">=</span> <span class="n">v47</span> <span class="o">+</span> <span class="n">v48</span> <span class="o">*</span> <span class="n">CT</span>

    <span class="n">b0</span> <span class="o">=</span> <span class="p">(</span><span class="n">v01</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v02</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v03</span> <span class="o">+</span> <span class="n">v04</span> <span class="o">*</span> <span class="n">CT</span><span class="p">))</span> <span class="o">+</span> <span class="n">SA</span> <span class="o">*</span> <span class="p">(</span><span class="n">v05</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v06</span> <span class="o">+</span>
          <span class="n">v07</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrtSA</span> <span class="o">*</span> <span class="p">(</span><span class="n">v08</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v09</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v10</span> <span class="o">+</span> <span class="n">v11</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)))))</span>

    <span class="n">b1</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">v12</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v13</span> <span class="o">+</span> <span class="n">v14</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)</span> <span class="o">+</span> <span class="n">SA</span> <span class="o">*</span> <span class="p">(</span><span class="n">v15</span> <span class="o">+</span> <span class="n">v16</span> <span class="o">*</span> <span class="n">CT</span><span class="p">))</span>

    <span class="n">b2</span> <span class="o">=</span> <span class="n">v17</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v18</span> <span class="o">+</span> <span class="n">v19</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)</span> <span class="o">+</span> <span class="n">v20</span> <span class="o">*</span> <span class="n">SA</span>

    <span class="n">b1sq</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">b1</span>

    <span class="n">sqrt_disc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">b1sq</span> <span class="o">-</span> <span class="n">b0</span> <span class="o">*</span> <span class="n">b2</span><span class="p">)</span>

    <span class="n">N</span> <span class="o">=</span> <span class="n">a0</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a3</span> <span class="o">*</span> <span class="n">b0</span> <span class="o">*</span> <span class="n">b1</span> <span class="o">/</span> <span class="n">b2</span> <span class="o">-</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">b0</span><span class="p">)</span> <span class="o">/</span> <span class="n">b2</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">a1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">a3</span> <span class="o">*</span> <span class="n">b1sq</span> <span class="o">/</span> <span class="n">b2</span> <span class="o">-</span> <span class="n">a3</span> <span class="o">*</span> <span class="n">b0</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">b1</span><span class="p">)</span> <span class="o">/</span> <span class="n">b2</span>

    <span class="n">A</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">-</span> <span class="n">sqrt_disc</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">+</span> <span class="n">sqrt_disc</span>

    <span class="n">part</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="n">b2</span> <span class="o">-</span> <span class="n">M</span> <span class="o">*</span> <span class="n">b1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">b2</span> <span class="o">*</span> <span class="p">(</span><span class="n">B</span> <span class="o">-</span> <span class="n">A</span><span class="p">))</span>

    <span class="sd">&quot;&quot;&quot;This function calculates dynamic_enthalpy using the computationally-</span>
<span class="sd">    efficient 48-term expression for density in terms of SA, CT and p.  If one</span>
<span class="sd">    wanted to compute dynamic_enthalpy from SA, CT, and p with the full TEOS-10</span>
<span class="sd">    Gibbs function, the following lines of code will enable this.</span>

<span class="sd">    dynamic_enthalpy = dynamic_enthalpy_CT_exact(SA, CT, p)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">db2Pascal</span> <span class="o">*</span> <span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="p">(</span><span class="n">a2</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">a3</span> <span class="o">*</span> <span class="n">b1</span> <span class="o">/</span> <span class="n">b2</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">a3</span> <span class="o">*</span> <span class="n">p</span><span class="p">)</span> <span class="o">/</span> <span class="n">b2</span> <span class="o">+</span>
                        <span class="p">(</span><span class="n">M</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">b2</span><span class="p">))</span> <span class="o">*</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">p</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">b1</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">p</span><span class="p">)</span> <span class="o">/</span> <span class="n">b0</span><span class="p">)</span> <span class="o">+</span> <span class="n">part</span> <span class="o">*</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">b2</span> <span class="o">*</span> <span class="n">p</span> <span class="o">*</span> <span class="p">(</span><span class="n">B</span> <span class="o">-</span> <span class="n">A</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="n">B</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">p</span><span class="p">))))</span></div>


<span class="nd">@match_args_return</span>
<div class="viewcode-block" id="enthalpy"><a class="viewcode-back" href="../../../gsw.gibbs.html#gsw.gibbs.density_enthalpy_48.enthalpy">[docs]</a><span class="k">def</span> <span class="nf">enthalpy</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates specific enthalpy of seawater using the computationally-</span>
<span class="sd">    efficient 48-term expression for density in terms of SA, CT and p</span>
<span class="sd">    (McDougall et al., 2011)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array_like</span>
<span class="sd">         Absolute Salinity  [g/kg]</span>
<span class="sd">    CT : array_like</span>
<span class="sd">         Conservative Temperature [:math:`^\circ` C (ITS-90)]</span>
<span class="sd">    p : array_like</span>
<span class="sd">        sea pressure [dbar]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    enthalpy : array_like</span>
<span class="sd">               specific enthalpy [J/kg]</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The 48-term equation has been fitted in a restricted range of parameter</span>
<span class="sd">    space, and is most accurate inside the &quot;oceanographic funnel&quot; described in</span>
<span class="sd">    McDougall et al. (2011).  The GSW library function &quot;infunnel(SA, CT, p)&quot; is</span>
<span class="sd">    available to be used if one wants to test if some of one&#39;s data lies</span>
<span class="sd">    outside this &quot;funnel&quot;.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    TODO</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] IOC, SCOR and IAPSO, 2010: The international thermodynamic equation</span>
<span class="sd">       of seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">       Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">       UNESCO (English), 196 pp. See Eqn. (A.30.6).</span>

<span class="sd">    .. [2] McDougall T.J., P.M. Barker, R. Feistel and D.R. Jackett, 2011:  A</span>
<span class="sd">       computationally efficient 48-term expression for the density of</span>
<span class="sd">       seawater in terms of Conservative Temperature, and related properties</span>
<span class="sd">       of seawater.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="n">sqrtSA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">SA</span><span class="p">)</span>

    <span class="n">a0</span> <span class="o">=</span> <span class="p">(</span><span class="n">v21</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v22</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v23</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v24</span> <span class="o">+</span> <span class="n">v25</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)))</span> <span class="o">+</span> <span class="n">SA</span> <span class="o">*</span>
          <span class="p">(</span><span class="n">v26</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v27</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v28</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v29</span> <span class="o">+</span> <span class="n">v30</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)))</span> <span class="o">+</span> <span class="n">v36</span> <span class="o">*</span> <span class="n">SA</span> <span class="o">+</span>
           <span class="n">sqrtSA</span> <span class="o">*</span> <span class="p">(</span><span class="n">v31</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v32</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v33</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v34</span> <span class="o">+</span> <span class="n">v35</span> <span class="o">*</span> <span class="n">CT</span><span class="p">))))))</span>

    <span class="n">a1</span> <span class="o">=</span> <span class="n">v37</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v38</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v39</span> <span class="o">+</span> <span class="n">v40</span> <span class="o">*</span> <span class="n">CT</span><span class="p">))</span> <span class="o">+</span> <span class="n">SA</span> <span class="o">*</span> <span class="p">(</span><span class="n">v41</span> <span class="o">+</span> <span class="n">v42</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)</span>

    <span class="n">a2</span> <span class="o">=</span> <span class="n">v43</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v44</span> <span class="o">+</span> <span class="n">v45</span> <span class="o">*</span> <span class="n">CT</span> <span class="o">+</span> <span class="n">v46</span> <span class="o">*</span> <span class="n">SA</span><span class="p">)</span>

    <span class="n">a3</span> <span class="o">=</span> <span class="n">v47</span> <span class="o">+</span> <span class="n">v48</span> <span class="o">*</span> <span class="n">CT</span>

    <span class="n">b0</span> <span class="o">=</span> <span class="p">(</span><span class="n">v01</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v02</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v03</span> <span class="o">+</span> <span class="n">v04</span> <span class="o">*</span> <span class="n">CT</span><span class="p">))</span> <span class="o">+</span> <span class="n">SA</span> <span class="o">*</span> <span class="p">(</span><span class="n">v05</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v06</span> <span class="o">+</span>
          <span class="n">v07</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrtSA</span> <span class="o">*</span> <span class="p">(</span><span class="n">v08</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v09</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v10</span> <span class="o">+</span> <span class="n">v11</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)))))</span>

    <span class="n">b1</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">v12</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v13</span> <span class="o">+</span> <span class="n">v14</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)</span> <span class="o">+</span> <span class="n">SA</span> <span class="o">*</span> <span class="p">(</span><span class="n">v15</span> <span class="o">+</span> <span class="n">v16</span> <span class="o">*</span> <span class="n">CT</span><span class="p">))</span>

    <span class="n">b2</span> <span class="o">=</span> <span class="n">v17</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v18</span> <span class="o">+</span> <span class="n">v19</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)</span> <span class="o">+</span> <span class="n">v20</span> <span class="o">*</span> <span class="n">SA</span>

    <span class="n">b1sq</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">b1</span>

    <span class="n">sqrt_disc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">b1sq</span> <span class="o">-</span> <span class="n">b0</span> <span class="o">*</span> <span class="n">b2</span><span class="p">)</span>

    <span class="n">N</span> <span class="o">=</span> <span class="n">a0</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a3</span> <span class="o">*</span> <span class="n">b0</span> <span class="o">*</span> <span class="n">b1</span> <span class="o">/</span> <span class="n">b2</span> <span class="o">-</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">b0</span><span class="p">)</span> <span class="o">/</span> <span class="n">b2</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">a1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">a3</span> <span class="o">*</span> <span class="n">b1sq</span> <span class="o">/</span> <span class="n">b2</span> <span class="o">-</span> <span class="n">a3</span> <span class="o">*</span> <span class="n">b0</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">b1</span><span class="p">)</span> <span class="o">/</span> <span class="n">b2</span>

    <span class="n">A</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">-</span> <span class="n">sqrt_disc</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">+</span> <span class="n">sqrt_disc</span>

    <span class="n">part</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="n">b2</span> <span class="o">-</span> <span class="n">M</span> <span class="o">*</span> <span class="n">b1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">b2</span> <span class="o">*</span> <span class="p">(</span><span class="n">B</span> <span class="o">-</span> <span class="n">A</span><span class="p">))</span>

    <span class="c1"># This function calculates enthalpy using the computationally-efficient</span>
    <span class="c1"># 48-term expression for density in terms of SA, CT and p.  If one wanted to</span>
    <span class="c1"># compute enthalpy from SA, CT, and p with the full TEOS-10 Gibbs function,</span>
    <span class="c1"># the following lines of code will enable this.</span>

    <span class="c1"># pt = pt_from_CT(SA, CT)</span>
    <span class="c1"># t = pt_from_t(SA, pt, 0, p)</span>
    <span class="c1"># enthalpy = enthalpy_t_exact(SA, t, p)</span>

    <span class="c1"># or call the following, it is identical to the lines above.</span>

    <span class="c1"># enthalpy = enthalpy_CT_exact(SA, CT, p)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">cp0</span> <span class="o">*</span> <span class="n">CT</span> <span class="o">+</span> <span class="n">db2Pascal</span> <span class="o">*</span>
            <span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="p">(</span><span class="n">a2</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">a3</span> <span class="o">*</span> <span class="n">b1</span> <span class="o">/</span> <span class="n">b2</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">a3</span> <span class="o">*</span> <span class="n">p</span><span class="p">)</span> <span class="o">/</span> <span class="n">b2</span> <span class="o">+</span> <span class="p">(</span><span class="n">M</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">b2</span><span class="p">))</span> <span class="o">*</span>
             <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">p</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">b1</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">p</span><span class="p">)</span> <span class="o">/</span> <span class="n">b0</span><span class="p">)</span> <span class="o">+</span> <span class="n">part</span> <span class="o">*</span>
             <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">b2</span> <span class="o">*</span> <span class="n">p</span> <span class="o">*</span> <span class="p">(</span><span class="n">B</span> <span class="o">-</span> <span class="n">A</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="n">B</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">p</span><span class="p">)))))</span></div>


<span class="nd">@match_args_return</span>
<div class="viewcode-block" id="enthalpy_diff"><a class="viewcode-back" href="../../../gsw.gibbs.html#gsw.gibbs.density_enthalpy_48.enthalpy_diff">[docs]</a><span class="k">def</span> <span class="nf">enthalpy_diff</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p_shallow</span><span class="p">,</span> <span class="n">p_deep</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the difference of the specific enthalpy of seawater between</span>
<span class="sd">    two different pressures, p_deep (the deeper pressure) and p_shallow (the</span>
<span class="sd">    shallower pressure), at the same values of SA and CT.  This function uses</span>
<span class="sd">    the computationally-efficient 48-term expression for density in terms of</span>
<span class="sd">    SA, CT and p (McDougall et al., 2011).  The output (enthalpy_diff_CT) is</span>
<span class="sd">    the specific enthalpy evaluated at (SA, CT, p_deep) minus the specific</span>
<span class="sd">    enthalpy at (SA, CT, p_shallow).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array_like</span>
<span class="sd">         Absolute Salinity  [g/kg]</span>
<span class="sd">    CT : array_like</span>
<span class="sd">         Conservative Temperature [:math:`^\circ` C (ITS-90)]</span>
<span class="sd">    p_shallow : array_like</span>
<span class="sd">                lower sea pressure [dbar]</span>
<span class="sd">    p_deep : array_like</span>
<span class="sd">             upper sea pressure [dbar]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    enthalpy_diff : array_like</span>
<span class="sd">                    difference of specific enthalpy [J/kg]</span>
<span class="sd">                    (deep minus shallow)</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The 48-term equation has been fitted in a restricted range of parameter</span>
<span class="sd">    space, and is most accurate inside the &quot;oceanographic funnel&quot; described in</span>
<span class="sd">    McDougall et al. (2011).  The GSW library function &quot;infunnel(SA, CT, p)&quot; is</span>
<span class="sd">    available to be used if one wants to test if some of one&#39;s data lies</span>
<span class="sd">    outside this &quot;funnel&quot;.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    TODO</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] IOC, SCOR and IAPSO, 2010: The international thermodynamic equation</span>
<span class="sd">       of seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">       Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">       UNESCO (English), 196 pp. See Eqns. (3.32.2) and (A.30.6).</span>

<span class="sd">    .. [2] McDougall T.J., P.M. Barker, R. Feistel and D.R. Jackett, 2011:  A</span>
<span class="sd">       computationally efficient 48-term expression for the density of</span>
<span class="sd">       seawater in terms of Conservative Temperature, and related properties</span>
<span class="sd">       of seawater.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="n">sqrtSA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">SA</span><span class="p">)</span>

    <span class="n">a0</span> <span class="o">=</span> <span class="p">(</span><span class="n">v21</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v22</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v23</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v24</span> <span class="o">+</span> <span class="n">v25</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)))</span> <span class="o">+</span> <span class="n">SA</span> <span class="o">*</span>
          <span class="p">(</span><span class="n">v26</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v27</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v28</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v29</span> <span class="o">+</span> <span class="n">v30</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)))</span> <span class="o">+</span> <span class="n">v36</span> <span class="o">*</span> <span class="n">SA</span> <span class="o">+</span>
           <span class="n">sqrtSA</span> <span class="o">*</span> <span class="p">(</span><span class="n">v31</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v32</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v33</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v34</span> <span class="o">+</span> <span class="n">v35</span> <span class="o">*</span> <span class="n">CT</span><span class="p">))))))</span>

    <span class="n">a1</span> <span class="o">=</span> <span class="n">v37</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v38</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v39</span> <span class="o">+</span> <span class="n">v40</span> <span class="o">*</span> <span class="n">CT</span><span class="p">))</span> <span class="o">+</span> <span class="n">SA</span> <span class="o">*</span> <span class="p">(</span><span class="n">v41</span> <span class="o">+</span> <span class="n">v42</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)</span>

    <span class="n">a2</span> <span class="o">=</span> <span class="n">v43</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v44</span> <span class="o">+</span> <span class="n">v45</span> <span class="o">*</span> <span class="n">CT</span> <span class="o">+</span> <span class="n">v46</span> <span class="o">*</span> <span class="n">SA</span><span class="p">)</span>

    <span class="n">a3</span> <span class="o">=</span> <span class="n">v47</span> <span class="o">+</span> <span class="n">v48</span> <span class="o">*</span> <span class="n">CT</span>

    <span class="n">b0</span> <span class="o">=</span> <span class="p">(</span><span class="n">v01</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v02</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v03</span> <span class="o">+</span> <span class="n">v04</span> <span class="o">*</span> <span class="n">CT</span><span class="p">))</span> <span class="o">+</span> <span class="n">SA</span> <span class="o">*</span> <span class="p">(</span><span class="n">v05</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v06</span> <span class="o">+</span>
          <span class="n">v07</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrtSA</span> <span class="o">*</span> <span class="p">(</span><span class="n">v08</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v09</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v10</span> <span class="o">+</span> <span class="n">v11</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)))))</span>

    <span class="n">b1</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">v12</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v13</span> <span class="o">+</span> <span class="n">v14</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)</span> <span class="o">+</span> <span class="n">SA</span> <span class="o">*</span> <span class="p">(</span><span class="n">v15</span> <span class="o">+</span> <span class="n">v16</span> <span class="o">*</span> <span class="n">CT</span><span class="p">))</span>

    <span class="n">b2</span> <span class="o">=</span> <span class="n">v17</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">v18</span> <span class="o">+</span> <span class="n">v19</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)</span> <span class="o">+</span> <span class="n">v20</span> <span class="o">*</span> <span class="n">SA</span>

    <span class="n">b1sq</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">b1</span>

    <span class="n">sqrt_disc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">b1sq</span> <span class="o">-</span> <span class="n">b0</span> <span class="o">*</span> <span class="n">b2</span><span class="p">)</span>

    <span class="n">N</span> <span class="o">=</span> <span class="n">a0</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a3</span> <span class="o">*</span> <span class="n">b0</span> <span class="o">*</span> <span class="n">b1</span> <span class="o">/</span> <span class="n">b2</span> <span class="o">-</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">b0</span><span class="p">)</span> <span class="o">/</span> <span class="n">b2</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">a1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">a3</span> <span class="o">*</span> <span class="n">b1sq</span> <span class="o">/</span> <span class="n">b2</span> <span class="o">-</span> <span class="n">a3</span> <span class="o">*</span> <span class="n">b0</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">b1</span><span class="p">)</span> <span class="o">/</span> <span class="n">b2</span>

    <span class="n">A</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">-</span> <span class="n">sqrt_disc</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">+</span> <span class="n">sqrt_disc</span>

    <span class="n">delta_p</span> <span class="o">=</span> <span class="n">p_deep</span> <span class="o">-</span> <span class="n">p_shallow</span>
    <span class="n">p_sum</span> <span class="o">=</span> <span class="n">p_deep</span> <span class="o">+</span> <span class="n">p_shallow</span>

    <span class="n">part1</span> <span class="o">=</span> <span class="n">b0</span> <span class="o">+</span> <span class="n">p_shallow</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">b1</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">p_shallow</span><span class="p">)</span>
    <span class="n">part2</span> <span class="o">=</span> <span class="p">(</span><span class="n">B</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">p_deep</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">p_shallow</span><span class="p">)</span>
    <span class="n">part3</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="n">b2</span> <span class="o">-</span> <span class="n">M</span> <span class="o">*</span> <span class="n">b1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">b2</span> <span class="o">*</span> <span class="p">(</span><span class="n">B</span> <span class="o">-</span> <span class="n">A</span><span class="p">))</span>

    <span class="c1"># This function calculates enthalpy_diff using the computationally</span>
    <span class="c1"># efficient 48-term expression for density in terms of SA, CT and p.  If one</span>
    <span class="c1"># wanted to compute the enthalpy difference using the full TEOS-10 Gibbs</span>
    <span class="c1"># function, the following lines of code will enable this.</span>

    <span class="c1"># pt = pt_from_CT(SA, CT)</span>
    <span class="c1"># t_shallow = pt_from_t(SA, pt, 0, p_shallow)</span>
    <span class="c1"># t_deep = pt_from_t(SA, pt, 0, p_deep)</span>
    <span class="c1"># enthalpy_diff = (enthalpy_t_exact(SA, t_deep, p_deep) -</span>
    <span class="c1">#                  enthalpy_t_exact(SA, t_shallow, p_shallow))</span>

    <span class="c1"># or call the following, it is identical to the lines above.</span>

    <span class="c1"># enthalpy_diff = enthalpy_diff_CT_exact(SA, CT, p_shallow, p_deep)</span>

    <span class="k">return</span> <span class="n">db2Pascal</span> <span class="o">*</span> <span class="p">(</span><span class="n">delta_p</span> <span class="o">*</span> <span class="p">(</span><span class="n">a2</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">a3</span> <span class="o">*</span> <span class="n">b1</span> <span class="o">/</span> <span class="n">b2</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">a3</span> <span class="o">*</span> <span class="n">p_sum</span><span class="p">)</span> <span class="o">/</span>
                        <span class="n">b2</span> <span class="o">+</span> <span class="p">(</span><span class="n">M</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">b2</span><span class="p">))</span> <span class="o">*</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">delta_p</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">b1</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">p_sum</span><span class="p">)</span> <span class="o">/</span> <span class="n">part1</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">part3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">delta_p</span> <span class="o">*</span> <span class="n">b2</span> <span class="o">*</span> <span class="p">(</span><span class="n">B</span> <span class="o">-</span> <span class="n">A</span><span class="p">)</span> <span class="o">/</span> <span class="n">part2</span><span class="p">))</span></div>


<span class="nd">@match_args_return</span>
<div class="viewcode-block" id="internal_energy"><a class="viewcode-back" href="../../../gsw.gibbs.html#gsw.gibbs.density_enthalpy_48.internal_energy">[docs]</a><span class="k">def</span> <span class="nf">internal_energy</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates specific internal energy of seawater using the</span>
<span class="sd">    computationally-efficient 48-term expression for density in terms of SA,</span>
<span class="sd">    CT and p (McDougall et al., 2011).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array_like</span>
<span class="sd">         Absolute Salinity  [g/kg]</span>
<span class="sd">    CT : array_like</span>
<span class="sd">         Conservative Temperature [:math:`^\circ` C (ITS-90)]</span>
<span class="sd">    p : array_like</span>
<span class="sd">        sea pressure [dbar]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    internal_energy : array_like</span>
<span class="sd">                      specific internal energy [J/kg]</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The 48-term equation has been fitted in a restricted range of parameter</span>
<span class="sd">    space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2011).  The GSW library function</span>
<span class="sd">    &quot;infunnel(SA, CT, p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    TODO</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] IOC, SCOR and IAPSO, 2010: The international thermodynamic equation</span>
<span class="sd">       of seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">       Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">       UNESCO (English), 196 pp.</span>

<span class="sd">    .. [2] McDougall T.J., P.M. Barker, R. Feistel and D.R. Jackett, 2011:  A</span>
<span class="sd">       computationally efficient 48-term expression for the density of</span>
<span class="sd">       seawater in terms of Conservative Temperature, and related properties</span>
<span class="sd">       of seawater.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="c1"># This function calculates enthalpy using the computationally-efficient</span>
    <span class="c1"># 48-term expression for density in terms of SA, CT and p. If one wanted to</span>
    <span class="c1"># compute enthalpy from SA, CT, and p with the full TEOS-10 Gibbs function,</span>
    <span class="c1"># the following line of code will enable this.</span>

    <span class="c1"># internal_energy = internal_energy_CT_exact(SA, CT, p)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">enthalpy</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">P0</span> <span class="o">+</span> <span class="n">db2Pascal</span> <span class="o">*</span> <span class="n">p</span><span class="p">)</span> <span class="o">*</span> <span class="n">specvol</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span></div>


<span class="nd">@match_args_return</span>
<div class="viewcode-block" id="rho"><a class="viewcode-back" href="../../../gsw.gibbs.html#gsw.gibbs.density_enthalpy_48.rho">[docs]</a><span class="k">def</span> <span class="nf">rho</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates in-situ density from Absolute Salinity and Conservative</span>
<span class="sd">    Temperature, using the computationally-efficient 48-term expression for</span>
<span class="sd">    density in terms of SA, CT and p (McDougall et al., 2011).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array_like</span>
<span class="sd">         Absolute Salinity  [g/kg]</span>
<span class="sd">    CT : array_like</span>
<span class="sd">         Conservative Temperature [:math:`^\circ` C (ITS-90)]</span>
<span class="sd">    p : array_like</span>
<span class="sd">        sea pressure [dbar]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    rho : array_like</span>
<span class="sd">          in-situ density [kg/m**3]</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The potential density with respect to reference pressure, pr, is obtained</span>
<span class="sd">    by calling this function with the pressure argument being pr (i.e.</span>
<span class="sd">    &quot;rho(SA,CT,pr)&quot;).</span>

<span class="sd">    The 48-term equation has been fitted in a restricted range of parameter</span>
<span class="sd">    space, and is most accurate inside the &quot;oceanographic funnel&quot; described in</span>
<span class="sd">    McDougall et al. (2011).  The GSW library function &quot;infunnel(SA,CT,p)&quot; is</span>
<span class="sd">    available to be used if one wants to test if some of one&#39;s data lies</span>
<span class="sd">    outside this &quot;funnel&quot;.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    TODO</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] IOC, SCOR and IAPSO, 2010: The international thermodynamic equation</span>
<span class="sd">       of seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">       Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">       UNESCO (English), 196 pp. See appendix A.20 and appendix K.</span>

<span class="sd">    .. [2] McDougall T.J., P.M. Barker, R. Feistel and D.R. Jackett, 2011:  A</span>
<span class="sd">       computationally efficient 48-term expression for the density of</span>
<span class="sd">       seawater in terms of Conservative Temperature, and related properties</span>
<span class="sd">       of seawater.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">sqrtSA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">SA</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">sqrtSA</span>

    <span class="c1"># This function calculates rho using the computationally-efficient 48-term</span>
    <span class="c1"># expression for density in terms of SA, CT and p. If one wanted to compute</span>
    <span class="c1"># rho from SA, CT, and p with the full TEOS-10 Gibbs function, the following</span>
    <span class="c1"># lines of code will enable this.</span>
    <span class="c1">#</span>
    <span class="c1"># pt0 = pt_from_CT(SA, CT)</span>
    <span class="c1"># t = pt_from_t(SA, pt0, 0, p)</span>
    <span class="c1"># rho = rho_t_exact(SA, t, p)</span>
    <span class="c1">#</span>
    <span class="c1"># or call the following, it is identical to the lines above.</span>
    <span class="c1">#</span>
    <span class="c1"># rho = rho_CT_exact(SA, CT, p)</span>
    <span class="c1">#</span>
    <span class="c1"># or call the following, it is identical to the lines above.</span>
    <span class="c1">#</span>
    <span class="c1"># rho,_ ,_ = rho_alpha_beta_CT_exact(SA, CT, p)</span>

    <span class="k">return</span> <span class="n">v_hat_denominator</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">/</span> <span class="n">v_hat_numerator</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span></div>


<div class="viewcode-block" id="rho_alpha_beta"><a class="viewcode-back" href="../../../gsw.gibbs.html#gsw.gibbs.density_enthalpy_48.rho_alpha_beta">[docs]</a><span class="k">def</span> <span class="nf">rho_alpha_beta</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates in-situ density, the appropriate thermal expansion</span>
<span class="sd">    coefficient and the appropriate saline contraction coefficient of seawater</span>
<span class="sd">    from Absolute Salinity and Conservative Temperature.  This function uses</span>
<span class="sd">    the computationally-efficient 48-term expression for density in terms of</span>
<span class="sd">    SA, CT and p (McDougall et al., 2011).</span>

<span class="sd">    The potential density (pot_rho) with respect to reference pressure p_ref is</span>
<span class="sd">    obtained by calling this function with the pressure argument being p_ref as</span>
<span class="sd">    in pot_rho, _, _] = rho_alpha_beta(SA, CT, p_ref).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array_like</span>
<span class="sd">         Absolute Salinity  [g/kg]</span>
<span class="sd">    CT : array_like</span>
<span class="sd">         Conservative Temperature [:math:`^\circ` C (ITS-90)]</span>
<span class="sd">    p : array_like</span>
<span class="sd">        sea pressure [dbar]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    rho : array_like</span>
<span class="sd">          in-situ density [kg/m**3]</span>
<span class="sd">    alpha : array_like</span>
<span class="sd">            thermal expansion coefficient [K :math:`-1`]</span>
<span class="sd">            with respect to Conservative Temperature</span>
<span class="sd">    beta : array_like</span>
<span class="sd">           saline contraction coefficient [kg g :math:`-1`]</span>
<span class="sd">           at constant Conservative Temperature.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The 48-term equation has been fitted in a restricted range of parameter</span>
<span class="sd">    space, and is most accurate inside the &quot;oceanographic funnel&quot; described in</span>
<span class="sd">    McDougall et al. (2011).  The GSW library function &quot;infunnel(SA, CT, p)&quot; is</span>
<span class="sd">    available to be used if one wants to test if some of one&#39;s data lies</span>
<span class="sd">    outside this &quot;funnel&quot;.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    TODO</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] IOC, SCOR and IAPSO, 2010: The international thermodynamic equation</span>
<span class="sd">       of seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">       Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">       UNESCO (English), 196 pp. See appendix A.20 and appendix K.</span>

<span class="sd">    .. [2] McDougall T.J., P.M. Barker, R. Feistel and D.R. Jackett, 2011:  A</span>
<span class="sd">      computationally efficient 48-term expression for the density of</span>
<span class="sd">      seawater in terms of Conservative Temperature, and related properties</span>
<span class="sd">      of seawater.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">rho</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">),</span> <span class="n">alpha</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">),</span> <span class="n">beta</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>


<span class="nd">@match_args_return</span>
<div class="viewcode-block" id="SA_from_rho"><a class="viewcode-back" href="../../../gsw.gibbs.html#gsw.gibbs.density_enthalpy_48.SA_from_rho">[docs]</a><span class="k">def</span> <span class="nf">SA_from_rho</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the Absolute Salinity of a seawater sample, for given values</span>
<span class="sd">    of its density, Conservative Temperature and sea pressure (in dbar).  This</span>
<span class="sd">    function uses the computationally-efficient 48-term expression for density</span>
<span class="sd">    in terms of SA, CT and p (McDougall et al., 2011).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rho : array_like</span>
<span class="sd">          density of a seawater sample [kg/m**3]</span>
<span class="sd">          This input has not had 1000 kg/m^3 subtracted from it</span>
<span class="sd">          (e.g. 1026 kg m**-3), that is, it is density, NOT density anomaly.</span>
<span class="sd">    CT : array_like</span>
<span class="sd">         Conservative Temperature [:math:`^\circ` C (ITS-90)]</span>
<span class="sd">    p : array_like</span>
<span class="sd">        sea pressure [dbar]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    SA : array_like</span>
<span class="sd">         Absolute Salinity  [g/kg]</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This is expressed on the Reference-Composition Salinity Scale of</span>
<span class="sd">    Millero et al. (2008).</span>

<span class="sd">    The 48-term equation has been fitted in a restricted range of parameter</span>
<span class="sd">    space, and is most accurate inside the &quot;oceanographic funnel&quot; described in</span>
<span class="sd">    McDougall et al. (2011).  The GSW library function &quot;infunnel(SA, CT, p)&quot; is</span>
<span class="sd">    available to be used if one wants to test if some of one&#39;s data lies</span>
<span class="sd">    outside this &quot;funnel&quot;.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    TODO</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] IOC, SCOR and IAPSO, 2010: The international thermodynamic equation</span>
<span class="sd">       of seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">       Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">       UNESCO (English), 196 pp. See section 2.5</span>

<span class="sd">    .. [2] McDougall T.J., P.M. Barker, R. Feistel and D.R. Jackett, 2011:  A</span>
<span class="sd">       computationally efficient 48-term expression for the density of</span>
<span class="sd">       seawater in terms of Conservative Temperature, and related properties</span>
<span class="sd">       of seawater.</span>

<span class="sd">    .. [3] Millero, F. J., R. Feistel, D. G. Wright, and T. J. McDougall, 2008:</span>
<span class="sd">       The composition of Standard Seawater and the definition of the</span>
<span class="sd">       Reference-Composition Salinity Scale, Deep-Sea Res. I, 55, 50-72.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">v_lab</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">rho</span>
    <span class="n">v_0</span> <span class="o">=</span> <span class="n">specvol</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">rho</span><span class="p">),</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="n">v_50</span> <span class="o">=</span> <span class="n">specvol</span><span class="p">(</span><span class="mi">50</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">rho</span><span class="p">),</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

    <span class="n">SA</span> <span class="o">=</span> <span class="mi">50</span> <span class="o">*</span> <span class="p">(</span><span class="n">v_lab</span> <span class="o">-</span> <span class="n">v_0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">v_50</span> <span class="o">-</span> <span class="n">v_0</span><span class="p">)</span>  <span class="c1"># Initial estimate of SA.</span>

    <span class="n">SA</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">SA</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">SA</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked</span>

    <span class="n">v_SA</span> <span class="o">=</span> <span class="p">(</span><span class="n">v_50</span> <span class="o">-</span> <span class="n">v_0</span><span class="p">)</span> <span class="o">/</span> <span class="mf">50.</span>  <span class="c1"># Initial v_SA estimate (SA derivative of v).</span>

    <span class="c1"># Begin the modified Newton-Raphson iterative procedure.</span>
    <span class="k">for</span> <span class="n">Number_of_iterations</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
        <span class="n">SA_old</span> <span class="o">=</span> <span class="n">SA</span>
        <span class="n">delta_v</span> <span class="o">=</span> <span class="n">specvol</span><span class="p">(</span><span class="n">SA_old</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">-</span> <span class="n">v_lab</span>
        <span class="c1"># Half way the mod. N-R method (McDougall and Wotherspoon, 2012)</span>
        <span class="n">SA</span> <span class="o">=</span> <span class="n">SA_old</span> <span class="o">-</span> <span class="n">delta_v</span> <span class="o">/</span> <span class="n">v_SA</span>  <span class="c1"># Half way through the mod. N-R method.</span>
        <span class="n">SA_mean</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">SA</span> <span class="o">+</span> <span class="n">SA_old</span><span class="p">)</span>
        <span class="n">rho</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="n">rho_alpha_beta</span><span class="p">(</span><span class="n">SA_mean</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
        <span class="n">v_SA</span> <span class="o">=</span> <span class="o">-</span><span class="n">beta</span> <span class="o">/</span> <span class="n">rho</span>
        <span class="n">SA</span> <span class="o">=</span> <span class="n">SA_old</span> <span class="o">-</span> <span class="n">delta_v</span> <span class="o">/</span> <span class="n">v_SA</span>
        <span class="n">SA</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">SA</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">SA</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked</span>

    <span class="c1"># After two iterations of this modified Newton-Raphson iteration,</span>
    <span class="c1"># the error in SA is no larger than 8x10^-13 g kg^-1, which</span>
    <span class="c1"># is machine precision for this calculation.</span>
    <span class="k">return</span> <span class="n">SA</span></div>


<div class="viewcode-block" id="sigma0"><a class="viewcode-back" href="../../../gsw.gibbs.html#gsw.gibbs.density_enthalpy_48.sigma0">[docs]</a><span class="k">def</span> <span class="nf">sigma0</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates potential density anomaly with reference pressure of 0 dbar,</span>
<span class="sd">    this being this particular potential density minus 1000 kg/m^3.  This</span>
<span class="sd">    function has inputs of Absolute Salinity and Conservative Temperature.</span>
<span class="sd">    This function uses the computationally-efficient 48-term expression for</span>
<span class="sd">    density in terms of SA, CT and p (McDougall et al., 2011).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array_like</span>
<span class="sd">         Absolute Salinity  [g/kg]</span>
<span class="sd">    CT : array_like</span>
<span class="sd">         Conservative Temperature [:math:`^\circ` C (ITS-90)]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sigma0 : array_like</span>
<span class="sd">             potential density anomaly with [kg/m**3]</span>
<span class="sd">             respect to a reference pressure of 0 dbar</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># This function calculates sigma0 using the computationally-efficient</span>
    <span class="c1"># 48-term expression for density in terms of SA, CT and p.  If one wanted</span>
    <span class="c1"># to compute sigma0 with the full TEOS-10 Gibbs function expression for</span>
    <span class="c1"># density, the following lines of code will enable this.</span>
    <span class="c1">#</span>
    <span class="c1"># sigma0 = rho_CT_exact(SA, CT, 0) - 1000</span>

    <span class="k">return</span> <span class="n">rho</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1000</span></div>


<div class="viewcode-block" id="sigma1"><a class="viewcode-back" href="../../../gsw.gibbs.html#gsw.gibbs.density_enthalpy_48.sigma1">[docs]</a><span class="k">def</span> <span class="nf">sigma1</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates potential density anomaly with reference pressure of 1000</span>
<span class="sd">    dbar, this being this particular potential density minus 1000 kg/m^3.</span>
<span class="sd">    This function has inputs of Absolute Salinity and Conservative Temperature.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array_like</span>
<span class="sd">         Absolute Salinity  [g/kg]</span>
<span class="sd">    CT : array_like</span>
<span class="sd">         Conservative Temperature [:math:`^\circ` C (ITS-90)]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sigma1 : array_like</span>
<span class="sd">             potential density anomaly with [kg/m**3]</span>
<span class="sd">             respect to a reference pressure of 1000 dbar</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># This function calculates sigma1 using the computationally-efficient</span>
    <span class="c1"># 48-term expression for density in terms of SA, CT and p.  If one wanted</span>
    <span class="c1"># to compute sigma1 with the full TEOS-10 Gibbs function expression for</span>
    <span class="c1"># density, the following lines of code will enable this.</span>
    <span class="c1">#</span>
    <span class="c1"># rho1 = rho_CT_exact(SA, CT, 1000)</span>

    <span class="k">return</span> <span class="n">rho</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="mf">1000.</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1000</span></div>


<div class="viewcode-block" id="sigma2"><a class="viewcode-back" href="../../../gsw.gibbs.html#gsw.gibbs.density_enthalpy_48.sigma2">[docs]</a><span class="k">def</span> <span class="nf">sigma2</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates potential density anomaly with reference pressure of 2000</span>
<span class="sd">    dbar, this being this particular potential density minus 1000 kg/m^3.</span>
<span class="sd">    This function has inputs of Absolute Salinity and Conservative Temperature.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array_like</span>
<span class="sd">         Absolute Salinity  [g/kg]</span>
<span class="sd">    CT : array_like</span>
<span class="sd">         Conservative Temperature [:math:`^\circ` C (ITS-90)]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sigma2 : array_like</span>
<span class="sd">             potential density anomaly with [kg/m**3]</span>
<span class="sd">             respect to a reference pressure of 2000 dbar</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># This function calculates sigma2 using the computationally-efficient</span>
    <span class="c1"># 48-term expression for density in terms of SA, CT and p.  If one wanted</span>
    <span class="c1"># to compute sigma2 with the full TEOS-10 Gibbs function expression for</span>
    <span class="c1"># density, the following lines of code will enable this.</span>
    <span class="c1">#</span>
    <span class="c1"># rho2 = rho_CT_exact(SA, CT, 2000.)</span>

    <span class="k">return</span> <span class="n">rho</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="mf">2000.</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1000</span></div>


<div class="viewcode-block" id="sigma3"><a class="viewcode-back" href="../../../gsw.gibbs.html#gsw.gibbs.density_enthalpy_48.sigma3">[docs]</a><span class="k">def</span> <span class="nf">sigma3</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates potential density anomaly with reference pressure of 3000</span>
<span class="sd">    dbar, this being this particular potential density minus 1000 kg/m^3.</span>
<span class="sd">    This function has inputs of Absolute Salinity and Conservative Temperature.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array_like</span>
<span class="sd">         Absolute Salinity  [g/kg]</span>
<span class="sd">    CT : array_like</span>
<span class="sd">         Conservative Temperature [:math:`^\circ` C (ITS-90)]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sigma1 : array_like</span>
<span class="sd">             potential density anomaly with [kg/m**3]</span>
<span class="sd">             respect to a reference pressure of 3000 dbar</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># This function calculates sigma3 using the computationally-efficient</span>
    <span class="c1"># 48-term expression for density in terms of SA, CT and p.  If one wanted</span>
    <span class="c1"># to compute sigma3 with the full TEOS-10 Gibbs function expression for</span>
    <span class="c1"># density, the following lines of code will enable this.</span>
    <span class="c1">#</span>
    <span class="c1"># rho3 = rho_CT_exact(SA, CT, 3000.)</span>

    <span class="k">return</span> <span class="n">rho</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="mf">3000.</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1000</span></div>


<div class="viewcode-block" id="sigma4"><a class="viewcode-back" href="../../../gsw.gibbs.html#gsw.gibbs.density_enthalpy_48.sigma4">[docs]</a><span class="k">def</span> <span class="nf">sigma4</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates potential density anomaly with reference pressure of 4000</span>
<span class="sd">    dbar, this being this particular potential density minus 1000 kg/m^3.</span>
<span class="sd">    This function has inputs of Absolute Salinity and Conservative Temperature.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array_like</span>
<span class="sd">         Absolute Salinity  [g/kg]</span>
<span class="sd">    CT : array_like</span>
<span class="sd">         Conservative Temperature [:math:`^\circ` C (ITS-90)]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sigma1 : array_like</span>
<span class="sd">             potential density anomaly with [kg/m**3]</span>
<span class="sd">             respect to a reference pressure of 4000 dbar</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># This function calculates sigma3 using the computationally-efficient</span>
    <span class="c1"># 48-term expression for density in terms of SA, CT and p.  If one wanted</span>
    <span class="c1"># to compute sigma3 with the full TEOS-10 Gibbs function expression for</span>
    <span class="c1"># density, the following lines of code will enable this.</span>
    <span class="c1">#</span>
    <span class="c1"># rho4 = rho_CT_exact(SA, CT, 4000.)</span>

    <span class="k">return</span> <span class="n">rho</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="mf">4000.</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1000</span></div>


<span class="nd">@match_args_return</span>
<div class="viewcode-block" id="sound_speed"><a class="viewcode-back" href="../../../gsw.gibbs.html#gsw.gibbs.density_enthalpy_48.sound_speed">[docs]</a><span class="k">def</span> <span class="nf">sound_speed</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the speed of sound in seawater.  This function has inputs of</span>
<span class="sd">    Absolute Salinity and Conservative Temperature.  This function uses the</span>
<span class="sd">    computationally-efficient 48-term expression for density in terms of SA,</span>
<span class="sd">    CT and p (McDougall et al., 2011).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array_like</span>
<span class="sd">         Absolute Salinity  [g/kg]</span>
<span class="sd">    CT : array_like</span>
<span class="sd">         Conservative Temperature [:math:`^\circ` C (ITS-90)]</span>
<span class="sd">    p : array_like</span>
<span class="sd">        sea pressure [dbar]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sound_speed : array_like</span>
<span class="sd">                  speed of sound in seawater [m/s]</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Approximate with a r.m.s. of 6.7 cm s^-1.</span>

<span class="sd">    The 48-term equation has been fitted in a restricted range of parameter</span>
<span class="sd">    space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2011).  The GSW library function</span>
<span class="sd">    &quot;infunnel(SA, CT, p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    TODO</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] IOC, SCOR and IAPSO, 2010: The international thermodynamic equation</span>
<span class="sd">       of seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">       Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">       UNESCO (English), 196 pp. See Eqn. (2.17.1).</span>

<span class="sd">    .. [2] McDougall T.J., P.M. Barker, R. Feistel and D.R. Jackett, 2011:  A</span>
<span class="sd">      computationally efficient 48-term expression for the density of</span>
<span class="sd">      seawater in terms of Conservative Temperature, and related properties</span>
<span class="sd">      of seawater.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">sqrtSA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">SA</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">sqrtSA</span>

    <span class="n">dvden_dp</span> <span class="o">=</span> <span class="p">(</span><span class="n">c01</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">c02</span> <span class="o">+</span> <span class="n">c03</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)</span> <span class="o">+</span> <span class="n">SA</span> <span class="o">*</span> <span class="p">(</span><span class="n">c04</span> <span class="o">+</span> <span class="n">c05</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)</span> <span class="o">+</span> <span class="n">p</span> <span class="o">*</span>
                <span class="p">(</span><span class="n">c06</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">c07</span> <span class="o">+</span> <span class="n">c08</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)</span> <span class="o">+</span> <span class="n">c09</span> <span class="o">*</span> <span class="n">SA</span><span class="p">))</span>

    <span class="n">dvnum_dp</span> <span class="o">=</span> <span class="p">(</span><span class="n">c10</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">c11</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">c12</span> <span class="o">+</span> <span class="n">c13</span> <span class="o">*</span> <span class="n">CT</span><span class="p">))</span> <span class="o">+</span> <span class="n">SA</span> <span class="o">*</span>
                <span class="p">(</span><span class="n">c14</span> <span class="o">+</span> <span class="n">c15</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)</span> <span class="o">+</span> <span class="n">p</span> <span class="o">*</span>
                <span class="p">(</span><span class="n">c16</span> <span class="o">+</span> <span class="n">CT</span> <span class="o">*</span> <span class="p">(</span><span class="n">c17</span> <span class="o">+</span> <span class="n">c18</span> <span class="o">*</span> <span class="n">CT</span> <span class="o">+</span> <span class="n">c19</span> <span class="o">*</span> <span class="n">SA</span><span class="p">)</span> <span class="o">+</span> <span class="n">p</span> <span class="o">*</span>
                 <span class="p">(</span><span class="n">c20</span> <span class="o">+</span> <span class="n">c21</span> <span class="o">*</span> <span class="n">CT</span><span class="p">)))</span>

    <span class="n">drho_dp</span> <span class="o">=</span> <span class="p">((</span><span class="n">dvden_dp</span> <span class="o">*</span> <span class="n">v_hat_numerator</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">-</span> <span class="n">dvnum_dp</span> <span class="o">*</span>
               <span class="n">v_hat_denominator</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">v_hat_numerator</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">*</span>
               <span class="n">v_hat_numerator</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)))</span>

    <span class="k">return</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="n">drho_dp</span><span class="p">)</span></div>


<span class="nd">@match_args_return</span>
<div class="viewcode-block" id="specvol"><a class="viewcode-back" href="../../../gsw.gibbs.html#gsw.gibbs.density_enthalpy_48.specvol">[docs]</a><span class="k">def</span> <span class="nf">specvol</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates specific volume from Absolute Salinity, Conservative</span>
<span class="sd">    Temperature and pressure, using the computationally-efficient 48-term</span>
<span class="sd">    expression for density (McDougall et al., 2011).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array_like</span>
<span class="sd">         Absolute Salinity  [g/kg]</span>
<span class="sd">    CT : array_like</span>
<span class="sd">         Conservative Temperature [:math:`^\circ` C (ITS-90)]</span>
<span class="sd">    p : array_like</span>
<span class="sd">        sea pressure [dbar]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    specvol : array_like</span>
<span class="sd">              specific volume [m**3/kg]</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The 48-term equation has been fitted in a restricted range of parameter</span>
<span class="sd">    space, and is most accurate inside the &quot;oceanographic funnel&quot; described in</span>
<span class="sd">    McDougall et al. (2011).  The GSW library function &quot;infunnel(SA,CT,p)&quot; is</span>
<span class="sd">    available to be used if one wants to test if some of one&#39;s data lies</span>
<span class="sd">    outside this &quot;funnel&quot;.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    TODO</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] IOC, SCOR and IAPSO, 2010: The international thermodynamic equation</span>
<span class="sd">       of seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">       Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">       UNESCO (English), 196 pp. See Eqn. (2.7.2).</span>

<span class="sd">    .. [2] McDougall T.J., P.M. Barker, R. Feistel and D.R. Jackett, 2011:  A</span>
<span class="sd">       computationally efficient 48-term expression for the density of</span>
<span class="sd">       seawater in terms of Conservative Temperature, and related properties</span>
<span class="sd">       of seawater.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="c1"># This function calculates specvol using the computationally-efficient</span>
    <span class="c1"># 48-term expression for density in terms of SA, CT and p. If one wanted to</span>
    <span class="c1"># compute specvol from SA, CT, and p with the full TEOS-10 Gibbs function,</span>
    <span class="c1"># the following lines of code will enable this.</span>
    <span class="c1">#</span>
    <span class="c1"># pt = pt_from_CT(SA, CT)</span>
    <span class="c1"># t = pt_from_t(SA, pt, 0, p)</span>
    <span class="c1"># specvol = specvol_t_exact(SA, t, p)</span>
    <span class="c1">#</span>
    <span class="c1"># or call the following, it is identical to the lines above.</span>
    <span class="c1">#</span>
    <span class="c1"># specvol = specvol_CT_exact(SA, CT, p)</span>

    <span class="n">SA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">sqrtSA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">SA</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">sqrtSA</span>

    <span class="k">return</span> <span class="n">v_hat_numerator</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">/</span> <span class="n">v_hat_denominator</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span></div>


<span class="nd">@match_args_return</span>
<div class="viewcode-block" id="specvol_anom"><a class="viewcode-back" href="../../../gsw.gibbs.html#gsw.gibbs.density_enthalpy_48.specvol_anom">[docs]</a><span class="k">def</span> <span class="nf">specvol_anom</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates specific volume anomaly from Absolute Salinity, Conservative</span>
<span class="sd">    Temperature and pressure.  It uses the computationally-efficient 48-term</span>
<span class="sd">    expression for density as a function of SA, CT and p (McDougall et al.,</span>
<span class="sd">    2011).  The reference value of Absolute Salinity is SSO and the reference</span>
<span class="sd">    value of Conservative Temperature is equal to 0 degrees C.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array_like</span>
<span class="sd">         Absolute Salinity  [g/kg]</span>
<span class="sd">    CT : array_like</span>
<span class="sd">         Conservative Temperature [:math:`^\circ` C (ITS-90)]</span>
<span class="sd">    p : array_like</span>
<span class="sd">        sea pressure [dbar]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    specvol_anom : array_like</span>
<span class="sd">                   specific volume anomaly [m**3/kg]</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The 48-term equation has been fitted in a restricted range of parameter</span>
<span class="sd">    space, and is most accurate inside the &quot;oceanographic funnel&quot; described in</span>
<span class="sd">    McDougall et al. (2011).  The GSW library function &quot;infunnel(SA,CT,p)&quot; is</span>
<span class="sd">    available to be used if one wants to test if some of one&#39;s data lies</span>
<span class="sd">    outside this &quot;funnel&quot;.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    TODO</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] IOC, SCOR and IAPSO, 2010: The international thermodynamic equation</span>
<span class="sd">       of seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">       Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">       UNESCO (English), 196 pp. See Eqn. (3.7.3).</span>

<span class="sd">    .. [2] McDougall T.J., P.M. Barker, R. Feistel and D.R. Jackett, 2011:  A</span>
<span class="sd">       computationally efficient 48-term expression for the density of</span>
<span class="sd">       seawater in terms of Conservative Temperature, and related properties</span>
<span class="sd">       of seawater.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">sqrtSA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">SA</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">sqrtSA</span>

    <span class="c1"># This function calculates specvol_anom using the computationally-</span>
    <span class="c1"># efficient 48-term expression for density in terms of SA, CT and p.  If</span>
    <span class="c1"># one wanted to compute specvol_anom from SA, CT, and p with the full</span>
    <span class="c1"># TEOS-10 Gibbs function, the following lines of code will enable this.</span>
    <span class="c1">#</span>
    <span class="c1"># pt = pt_from_CT(SA, CT)</span>
    <span class="c1"># t = pt_from_t(SA, pt, 0, p)</span>
    <span class="c1"># specvol_anom = specvol_anom_t_exact(SA, t, p)</span>
    <span class="c1">#</span>
    <span class="c1"># or call the following, it is identical to the lines above.</span>
    <span class="c1">#</span>
    <span class="c1"># specvol_anom = specvol_anom_CT_exact(SA, CT, p)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">v_hat_numerator</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">/</span> <span class="n">v_hat_denominator</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">-</span>
            <span class="n">specvol_SSO_0_p</span><span class="p">(</span><span class="n">p</span><span class="p">))</span></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">doctest</span>
    <span class="n">doctest</span><span class="o">.</span><span class="n">testmod</span><span class="p">()</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Author.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
    </div>

    

    
  </body>
</html>